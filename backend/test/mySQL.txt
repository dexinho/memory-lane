CREATE TABLE users (
    user_id INT PRIMARY KEY AUTO_INCREMENT UNIQUE,
    user_picture_id INT,
    email VARCHAR(30) UNIQUE NOT NULL,
    password VARCHAR(40) NOT NULL,
    password_hash VARCHAR(255) NOT NULL,
    first_name VARCHAR(30) NOT NULL,
    last_name VARCHAR(30) NOT NULL,
    FOREIGN KEY (user_picture_id)
        REFERENCES pictures (picture_id)
);

CREATE TABLE pictures (
    picture_id INT PRIMARY KEY AUTO_INCREMENT,
    picture_url VARCHAR(255) UNIQUE
);

CREATE TABLE timelines (
    timeline_id INT PRIMARY KEY AUTO_INCREMENT,
    timeline_title varchar(40),
    background_color varchar(20),
    font_color varchar(20),
    font_family varchar(30),
    is_public BOOLEAN,
    user_id INT,
    view_count INT,
    FOREIGN KEY (user_id)
        REFERENCES users (user_id)
        ON DELETE CASCADE
);

CREATE TABLE timeline_visits (
    visit_id INT PRIMARY KEY AUTO_INCREMENT,
    timeline_id INT,
    visitor_user_id INT,
    FOREIGN KEY (timeline_id) REFERENCES timelines(timeline_id) ON DELETE CASCADE,
    FOREIGN KEY (visitor_user_id) REFERENCES users(user_id) ON DELETE CASCADE
);

CREATE TABLE memories (
    event_id INT AUTO_INCREMENT,
    event_date DATE,
    picture_name VARCHAR(30),
    picture_id VARCHAR(255),
    timeline_id INT,
    description TEXT,
    FOREIGN KEY (timeline_id)
        REFERENCES timelines (timeline_id)
        ON DELETE CASCADE,
    FOREIGN KEY (picture_id)
        REFERENCES pictures (picture_id)
        ON DELETE CASCADE
);

